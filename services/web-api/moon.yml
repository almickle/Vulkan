layer: "application"
language: "typescript"
dependsOn:
  - storage-adapter

tasks:
  generate:
    command: "prisma generate; node scripts/post-generate.js"
    inputs:
      - "prisma/*.prisma"
      - ".env"
    deps:
      - "validate"

  migrate:
    command: "prisma migrate prod"
    inputs:
      - "prisma/*.prisma"
      - ".env"
    deps:
      - "validate"

  migrate-dev:
    command: "prisma migrate dev --name $(date +%Y%m%d%H%M%S)"
    options:
      interactive: true
    inputs:
      - "prisma/*.prisma"
      - ".env"
    deps:
      - "validate"

  validate:
    command: "prisma validate"
    inputs:
      - "prisma/*.prisma"
