# Global tasks configuration
# https://moonrepo.dev/docs/config/tasks

tasks:
  build:
    command: "tsc"
    args: []
    inputs:
      - "tsconfig.json"
      - "src/**/*.ts"
      - "!**/node_modules/**"

  rebuild:
    extends: "build"
    options:
      cache: false

  format:
    command: "prettier --write ."
    inputs:
      - "**/*.{ts,tsx,js,jsx,json,md,mdx,html,css,scss}"
      - "!**/node_modules/**"
      - "!**/build/**"

  ### Non mutating tasks ###

  lint:
    command: "eslint . --ext .ts,.tsx,.js,.jsx"
    inputs:
      - "**/*.{ts,tsx,js,jsx}"
      - "!**/node_modules/**"
      - "!**/build/**"
    deps:
      - "^:build"

  type-check:
    command: "tsc --noEmit"
    inputs:
      - "**/*.{ts,tsx}"
      - "!**/node_modules/**"
      - "!**/build/**"
    deps:
      - "^:build"

  ### Persistent tasks ###

  host:
    command: "node"
    args: ["./dist/index.js", "--inspect-brk"]
    inputs:
      - "dist/**"
    preset: "server"
    deps:
      - "^:build"
